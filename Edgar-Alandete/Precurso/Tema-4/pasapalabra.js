// La finalizacion de la incialización, es la línea 219.
let questions = [
  {
    letter: "a",
    status: 0,
    questionList: [
      {
        answer: "abducir",
        question:
          "CON LA A. Dicho de una supuesta criatura extraterrestre: Apoderarse de alguien",
      },
      { answer: "asgard", question: "CON LA A. Mundo originario de Thor." },
      { answer: "amanecer", question: "CON LA A. Inicio de un dia" },
    ],
  },
  {
    letter: "b",
    status: 0,
    questionList: [
      {
        answer: "bingo",
        question:
          "CON LA B. Juego que ha sacado de quicio a todos los 'Skylabers' en las sesiones de precurso",
      },
      { answer: "batman", question: "CON LA B. He is vengeance" },
      {
        answer: "bartomeu",
        question: "CON LA B. Peor presidente de la historia del FC Barcelona",
      },
    ],
  },
  {
    letter: "c",
    status: 0,
    questionList: [
      { answer: "churumbel", question: "CON LA C. Niño, crío, bebé" },
      {
        answer: "churros",
        question:
          "CON LA C. Desayuno típico cuando vuelves de fiesta de marina",
      },
      { answer: "calvo", question: "CON LA C. Sin pelo" },
    ],
  },
  {
    letter: "d",
    status: 0,
    questionList: [
      {
        answer: "diarrea",
        question:
          "CON LA D. Anormalidad en la función del aparato digestivo caracterizada por frecuentes evacuaciones y su consistencia líquida",
      },
      {
        answer: "dardo",
        question: "CON LA D. Objeto que se lanza contra una diana",
      },
      {
        answer: "dado",
        question:
          "CON LA D. Suele tener 6 caras. Usado para jugar a juegos de mesa",
      },
    ],
  },
  {
    letter: "e",
    status: 0,
    questionList: [
      {
        answer: "ectoplasma",
        question:
          "CON LA E. Gelatinoso y se encuentra debajo de la membrana plasmática. Los cazafantasmas medían su radiación",
      },
      { answer: "erudito", question: "CON LA E. Persona que tiene erudición" },
      {
        answer: "esparta",
        question: "CON LA E. Capital de Laconia ciudad de Leonidas",
      },
    ],
  },
  {
    letter: "f",
    status: 0,
    questionList: [
      {
        answer: "facil",
        question:
          "CON LA F. Que no requiere gran esfuerzo, capacidad o dificultad",
      },
      {
        answer: "figura",
        question: "CON LA F. Persona más importante de un equipo.",
      },
      { answer: "ficticio", question: "CON LA F. Que no es real" },
    ],
  },
  {
    letter: "g",
    status: 0,
    questionList: [
      {
        answer: "galaxia",
        question:
          "CON LA G. Conjunto enorme de estrellas, polvo interestelar, gases y partículas",
      },
      {
        answer: "gato",
        question: "CON LA G. Animal domésitico independiente e impredecible",
      },
      {
        answer: "guitarra",
        question: "CON LA G. Instrumento musical de 6 cuerdas",
      },
    ],
  },
  {
    letter: "h",
    status: 0,
    questionList: [
      {
        answer: "harakiri",
        question: "CON LA H. Suicidio ritual japonés por desentrañamiento",
      },
      {
        answer: "heroe",
        question:
          "CON LA H. Dicese de aquella persona que comete una heroicidad",
      },
      {
        answer: "hacienda",
        question: "CON LA H. La pesadilla que cada año te pega un palo",
      },
    ],
  },
  {
    letter: "i",
    status: 0,
    questionList: [
      { answer: "iglesia", question: "CON LA I. Templo cristiano" },
      {
        answer: "irrisorio",
        question: "CON LA I. Que no importa nada. Poca cosa",
      },
      {
        answer: "invisible",
        question: "CON LA I. Aquello que no tiene visibilidad",
      },
    ],
  },
  {
    letter: "j",
    status: 0,
    questionList: [
      {
        answer: "jabali",
        question:
          "CON LA J. Variedad salvaje del cerdo que sale en la película 'El Rey León', de nombre Pumba",
      },
      {
        answer: "jamon",
        question: "CON LA J. Embutido por el cual es famoso España",
      },
      { answer: "jamas", question: "CON LA J. Sinonimo de nunca" },
    ],
  },
  {
    letter: "k",
    status: 0,
    questionList: [
      {
        answer: "kamikaze",
        question:
          "CON LA K. Persona que se juega la vida realizando una acción temeraria",
      },
      {
        answer: "goku",
        question:
          "Contiene la K. Heroe proviniente del planeta Vegeta que ha salvado la tierra en diferentes ocasiones.",
      },
      { answer: "kilo", question: "CON LA K. 1000 gramos" },
    ],
  },
  {
    letter: "l",
    status: 0,
    questionList: [
      { answer: "licantropo", question: "CON LA L. Hombre lobo" },
      {
        answer: "lugubre",
        question:
          "CON LA L. Que es oscuro o sombrío y recuerda lo relacionado con la muerte o el más allá.",
      },
      {
        answer: "lugarteniente",
        question:
          "CON LA L. Persona con autoridad y poder para sustituir a otro en algún cargo.",
      },
    ],
  },
  {
    letter: "m",
    status: 0,
    questionList: [
      {
        answer: "misantropo",
        question:
          "CON LA M. Persona que huye del trato con otras personas o siente gran aversión hacia ellas",
      },
      { answer: "mama", question: "CON LA M. Coloquial de madre" },
      {
        answer: "marisco",
        question:
          "CON LA M. Animal marino invertebrado, y especialmente los crustáceos y moluscos comestible",
      },
    ],
  },
  {
    letter: "n",
    status: 0,
    questionList: [
      {
        answer: "necedad",
        question: "CON LA N. Demostración de poca inteligencia",
      },
      {
        answer: "ninfa",
        question:
          "CON LA N. Cada una de las fabulosas deidades de las aguas, bosques, selvas, et",
      },
      {
        answer: "nectar",
        question:
          "CON LA N. Jugo azucarado, producido por los nectarios, que chupan las abejas y otros insectos",
      },
    ],
  },
  {
    letter: "ñ",
    status: 0,
    questionList: [
      {
        answer: "señal",
        question:
          "CONTIENE LA Ñ. Indicio que permite deducir algo de lo que no se tiene un conocimiento directo.",
      },
      {
        answer: "pañal",
        question: "CONTIENE LA Ñ. Usado por bebes para hacer sus necesidades",
      },
      {
        answer: "ñu",
        question: "CON LA Ñ. Animal responsable de la muerte de Mufasa",
      },
    ],
  },
  {
    letter: "o",
    status: 0,
    questionList: [
      {
        answer: "orco",
        question:
          "CON LA O. Humanoide fantástico de apariencia terrible y bestial, piel de color verde creada por el escritor Tolkien",
      },
      {
        answer: "orbita",
        question:
          "CON LA O. Ámbito en que se percibe la influencia de algo o de alguien",
      },
      { answer: "oscuro", question: "CON LA O. No se ve" },
    ],
  },
  {
    letter: "p",
    status: 0,
    questionList: [
      {
        answer: "protoss",
        question:
          "CON LA P. Raza ancestral tecnológicamente avanzada que se caracteriza por sus grandes poderes psíonicos del videojuego StarCraft",
      },
      { answer: "paseo", question: "CON LA P. Ación de pasear o pasearse." },
      { answer: "picante", question: "CON LA P. Que pica" },
    ],
  },
  {
    letter: "q",
    status: 0,
    questionList: [
      {
        answer: "queso",
        question:
          "CON LA Q. Producto obtenido por la maduración de la cuajada de la leche",
      },
      {
        answer: "quad",
        question:
          "CON LA Q. Vehículo todoterreno de cuatro ruedas similar a una motocicleta.",
      },
      {
        answer: "quebrar",
        question: "CON LA Q. Romper, separar con violencia.",
      },
    ],
  },
  {
    letter: "r",
    status: 0,
    questionList: [
      { answer: "raton", question: "CON LA R. Roedor" },
      {
        answer: "rock",
        question:
          "CON LA R. Genero musical popularizado en los años 50 en Estados Unidos",
      },
      {
        answer: "robe",
        question: "CON LA R. Nombre del cantante y lider de Extremoduro",
      },
    ],
  },
  {
    letter: "s",
    status: 0,
    questionList: [
      {
        answer: "stackoverflow",
        question:
          "CON LA S. Comunidad salvadora de todo desarrollador informático",
      },
      {
        answer: "superar",
        question: "CON LA S. Vencer obstaculos o dificultades",
      },
      {
        answer: "skylab",
        question: "CON LA S. Academia de programacion donde lo vamos a petar",
      },
    ],
  },
  {
    letter: "t",
    status: 0,
    questionList: [
      {
        answer: "terminator",
        question:
          "CON LA T. Película del director James Cameron que consolidó a Arnold Schwarzenegger como actor en 1984",
      },
      { answer: "temor", question: "CON LA T. Recelo de un daño futuro." },
      {
        answer: "tarantino",
        question:
          "CON LA T. Director de Kill Bill o Reservoir Dogs entre otras películas.",
      },
    ],
  },
  {
    letter: "u",
    status: 0,
    questionList: [
      {
        answer: "unamuno",
        question:
          "CON LA U. Escritor y filósofo español de la generación del 98 autor del libro 'Niebla' en 1914",
      },
      { answer: "unico", question: "CON LA U. Que solo pasa una vez" },
      {
        answer: "uralita",
        question:
          "CON LA U. Material de construcción hecho a base de cemento y de fibras, generalmente de asbesto, usado sobre todo en cubiertas y tejados.",
      },
    ],
  },
  {
    letter: "v",
    status: 0,
    questionList: [
      {
        answer: "vikingos",
        question:
          "CON LA V. Nombre dado a los miembros de los pueblos nórdicos originarios de Escandinavia, famosos por sus incursiones y pillajes en Europa",
      },
      {
        answer: "vaca",
        question: "CON LA V. Animal del que se puede extraer leche.",
      },
      { answer: "variado", question: "CON LA V. Diferente" },
    ],
  },
  {
    letter: "w",
    status: 0,
    questionList: [
      {
        answer: "sandwich",
        question:
          "CONTIENE LA W. Emparedado hecho con dos rebanadas de pan entre las cuales se coloca jamón y queso",
      },
      { answer: "web", question: "CON LA W. Red informatica" },
      {
        answer: "whiskey",
        question:
          "CON LA W. Bebida alcoholica de alta graduación popular en Irlanda",
      },
    ],
  },
  {
    letter: "x",
    status: 0,
    questionList: [
      {
        answer: "botox",
        question:
          "CONTIENE LA X. Toxina bacteriana utilizada en cirujía estética",
      },
      {
        answer: "xilofono",
        question:
          "CON LA X. Instrumento musical de percusión formado por láminas generalmente de madera, ordenadas horizontalmente según su tamaño y sonido, que se hacen sonar golpeándolas con dos baquetas.",
      },
      {
        answer: "expediente",
        question:
          "CONTIENE LA X. Conjunto de todos los papeles correspondientes a un asunto o negocio",
      },
    ],
  },
  {
    letter: "y",
    status: 0,
    questionList: [
      {
        answer: "peyote",
        question:
          "CONTIENE LA Y. Pequeño cáctus conocido por sus alcaloides psicoactivos utilizado de forma ritual y medicinal  por indígenas americanos",
      },
      {
        answer: "popeye",
        question: "CONTIENE LA Y. Personaje de ficcion que adora las espinacas",
      },
      { answer: "yoda", question: "CON LA Y. Maestro jedi de color verde." },
    ],
  },
  {
    letter: "z",
    status: 0,
    questionList: [
      {
        answer: "zen",
        question:
          "CON LA Z. Escuela de budismo que busca la experiencia de la sabiduría más allá del discurso racional",
      },
      {
        answer: "zoo",
        question:
          "CON LA Z. Lugar donde se pueden ver animales de diferentes paises",
      },
      {
        answer: "zinc",
        question: "CON LA Z. Elemento químico metálico, de núm. atóm. 30",
      },
    ],
  },
];
let ranking = [];
const SKIP_WORD = "pasapalabra";
const END_GAME = "end";
const WORD_ANSWER = {
  CORRECT: 1,
  UNANSWERD: 0,
  INCORRECT: -1,
  END: -2,
};
const TOTAL_WORDS = 27;

function pasapalabra() {
  let playerName = "EDG";
  let continuePlaying = true;
  while (continuePlaying) {
    playerName = prompt("Introduce tu nombre: ");
    let donut = createDonut();
    let answeredDonut = playPasapalabra(donut);
    endPasapalabra(playerName, answeredDonut);
    continuePlaying = confirm(`Quieres jugar de nuevo?`);
  }
}

function createDonut() {
  let donut = [];
  questions.forEach((question) => {
    donut.push(createQuestionObj(question));
  });

  return donut;
}

let createQuestionObj = (question) => {
  let randomQuestion = getRamdomQuestion(question.questionList);
  return {
    letter: question.letter,
    status: question.status,
    answer: randomQuestion.answer,
    question: randomQuestion.question,
  };
};

function getRamdomQuestion(questionList) {
  return questionList[Math.floor(Math.random() * questionList.length)];
}
function playPasapalabra(donut) {
  let answeredDonut = [];
  let playerAnswer;
  let answerStatus;
  let isEndGame = false;

  do {
    for (let i = 0; i < donut.length && !isEndGame; i++) {
      playerAnswer = getPlayerAnswer(donut[i].question);
      answerStatus = checkAnswer(playerAnswer, donut[i].answer);
      updateAnswer(donut, i, answerStatus);
      isEndGame = answerStatus === WORD_ANSWER.END;
    }
    donut = updateDonuts(donut, answeredDonut);
  } while (answeredDonut.length !== TOTAL_WORDS && !isEndGame);

  return answeredDonut;
}

function getPlayerAnswer(question) {
  let playerAnswer = prompt(question);
  return playerAnswer === null || playerAnswer === ""
    ? SKIP_WORD
    : playerAnswer.toLowerCase();
}

function checkAnswer(playerAnswer, answer) {
  let answerStatus = 0;
  if (playerAnswer === answer) {
    answerStatus = WORD_ANSWER.CORRECT;
  } else {
    switch (playerAnswer) {
      case SKIP_WORD:
        answerStatus = WORD_ANSWER.UNANSWERD;
        break;
      case END_GAME:
        answerStatus = WORD_ANSWER.END;
        break;
      default:
        answerStatus = WORD_ANSWER.INCORRECT;
    }
  }
  return answerStatus;
}

function updateAnswer(donut, i, answerStatus) {
  if (answerStatus !== WORD_ANSWER.UNANSWERD) {
    donut[i].status = answerStatus;
  }
}

function updateDonuts(donut, answeredDonut) {
  donut.forEach((word) => {
    if (word.status !== WORD_ANSWER.UNANSWERD) {
      answeredDonut.push(word);
    }
  });

  return donut.filter((e) => e.status === WORD_ANSWER.UNANSWERD);
}

function endPasapalabra(playerName, answeredDonut) {
  let playerResults = getPlayerResults(answeredDonut);
  showPlayerResults(playerResults);
  addPlayerToRanking(playerName, playerResults);
  sortRanking();
  showRanking();
}

function getPlayerResults(answeredDonut) {
  let correctAnswers = getAnswers(answeredDonut, WORD_ANSWER.CORRECT);
  let incorrectAnswers = getAnswers(answeredDonut, WORD_ANSWER.INCORRECT);

  return { correct: correctAnswers, incorrect: incorrectAnswers };
}

function getAnswers(answeredDonut, answerType) {
  return answeredDonut.reduce(function (n, word) {
    return n + (word.status === answerType);
  }, 0);
}

function showPlayerResults(playerResults) {
  console.log(`Tus resultados son
              ACIERTOS: ${playerResults.correct}
              FALLOS: ${playerResults.incorrect}`);
}

function addPlayerToRanking(playerName, playerResults) {
  if (playerResults.correct + playerResults.incorrect === TOTAL_WORDS) {
    ranking.push(createPlayerObj(playerName, playerResults));
  } else {
    console.log(`No se ha incluido al jugador por no completar el rosco.`);
  }
}

let createPlayerObj = (playerName, playerResults) => {
  return {
    name: playerName,
    results: playerResults,
  };
};

function sortRanking() {
  ranking.sort((a, b) => b.results.correct - a.results.correct);
}

function showRanking() {
  if (ranking.length < 1) {
    console.log(`No hay resultados para mostrar`);
  } else {
    console.log(
      ` =========================== RANKING =========================== `
    );
    console.log(
      ` ==== JUGADOR ==================================== ACIERTOS ==== `
    );
    ranking.forEach((player) => {
      console.log(
        ` ==== ${player.name} =================================== ${player.results.correct} ==== `
      );
    });
  }
}
